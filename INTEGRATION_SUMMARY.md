# üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Token+Proxy —Å–∏—Å—Ç–µ–º—ã

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1Ô∏è‚É£ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
Total Cached Proxies: 200 (–≤–º–µ—Å—Ç–æ 100!)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –í Web UI –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –û–ë–ê: proxy_list (paste) –ò proxy_list_link (WebShare API)
- –ö–æ–¥ —Å–∫–ª–∞–¥—ã–≤–∞–ª –∏—Ö: 100 + 100 = 200 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: proxy_list_link > proxy_list
if proxy_list_link:
    all_proxies = fetch_from_link()  # 100 –ø—Ä–æ–∫—Å–∏
    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º proxy_list —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
else:
    all_proxies = parse_proxy_list()  # –ò–ª–∏ —Ä—É—á–Ω–æ–π —Å–ø–∏—Å–æ–∫

# + –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
all_proxies = list(dict.fromkeys(all_proxies))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Total Cached Proxies: 100 ‚úÖ
```

---

### 2Ô∏è‚É£ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ Token+Proxy binding**

#### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**–¢–æ–∫–µ–Ω –∏ –ü—Ä–æ–∫—Å–∏ –∂–∏–≤—É—Ç –≤–º–µ—Å—Ç–µ –∫–∞–∫ –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–∞—è –ø–∞—Ä–∞!**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Token A + Proxy X     ‚îÇ ‚Üê –°–æ–∑–¥–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ
‚îÇ  (1 –ø–∞—Ä–∞ = 1 IP)       ‚îÇ ‚Üê –ñ–∏–≤—É—Ç –≤–º–µ—Å—Ç–µ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚Üê –£–º–∏—Ä–∞—é—Ç –≤–º–µ—Å—Ç–µ
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**TokenSession** (–æ–±–Ω–æ–≤–ª–µ–Ω):
```python
class TokenSession:
    def __init__(self, session_id, session, access_token, user_agent, proxy):
        self.proxy = proxy  # ‚Üê –ù–û–í–û–ï: –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ç–æ–∫–µ–Ω—É
        self.scan_count = 0  # ‚Üê –ù–û–í–û–ï: —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏
```

**TokenPool** (–Ω–æ–≤—ã–π –º–µ—Ç–æ–¥):
```python
def create_fresh_pair(self, worker_index):
    """–°–æ–∑–¥–∞—Ç—å —Å–≤–µ–∂—É—é –ø–∞—Ä—É Token + Proxy"""
    proxy = get_random_proxy()  # –ù–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏ –∏–∑ –ø—É–ª–∞
    session = self._create_new_session_with_proxy(proxy)
    self.sessions[worker_index] = session  # –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—É—é –ø–∞—Ä—É
    return session
```

**Items.search()** (—É–ø—Ä–æ—â–µ–Ω):
```python
# ‚ùå –£–î–ê–õ–ï–ù–û:
# proxy_dict = proxies.get_random_proxy()  # –°–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ–∫—Å–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑
# self.session.proxies.update(converted_proxy)

# ‚úÖ –ü—Ä–æ–∫—Å–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ session –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ä—ã
response = self.session.get(...)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –ø—Ä–æ–∫—Å–∏!
```

**Worker** (–æ–±–Ω–æ–≤–ª–µ–Ω):
```python
while True:
    # 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 5 —Å–∫–∞–Ω–æ–≤
    if token_session.needs_rotation(5):
        token_session = token_pool.create_fresh_pair(worker_index)
        vinted = Vinted(session=token_session.session)
    
    # 2. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
    search_result = vinted.items.search(url)
    
    # 3. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞
    if success:
        token_session.increment_scan()  # 1, 2, 3, 4, 5...
    
    # 4. –ü—Ä–∏ –æ—à–∏–±–∫–µ 403: –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–º–µ–Ω–∞
    elif error_403:
        for retry in range(3):
            token_session = token_pool.create_fresh_pair(worker_index)
            vinted = Vinted(session=token_session.session)
            retry_result = vinted.items.search(url)
            if success:
                break
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
```
–¢–æ–∫–µ–Ω –≤—Å–µ–≥–¥–∞ —Å –æ–¥–Ω–æ–≥–æ IP
‚Üí Vinted –≤–∏–¥–∏—Ç "–Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
‚Üí –ú–µ–Ω—å—à–µ –±–∞–Ω–æ–≤!
```

### ‚úÖ **–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è**
```
–ö–∞–∂–¥—ã–µ 5 —Å–∫–∞–Ω–æ–≤ ‚Üí –Ω–æ–≤–∞—è –ø–∞—Ä–∞ Token + Proxy
‚Üí –ù–µ –∂–¥–µ–º –ø–æ–∫–∞ —Ç–æ–∫–µ–Ω —É–º—Ä–µ—Ç
‚Üí –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```

### ‚úÖ **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**
```
–ü–æ–ª—É—á–∏–ª–∏ 403 ‚Üí –Ω–æ–≤–∞—è –ø–∞—Ä–∞ ‚Üí retry #1
–û–ø—è—Ç—å 403 ‚Üí –µ—â–µ –Ω–æ–≤–∞—è –ø–∞—Ä–∞ ‚Üí retry #2
–û–ø—è—Ç—å 403 ‚Üí –µ—â–µ –Ω–æ–≤–∞—è –ø–∞—Ä–∞ ‚Üí retry #3
‚Üí –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ!
```

### ‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏**
```
100 residential –ø—Ä–æ–∫—Å–∏ = 100 "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
‚Üí –ö–∞–∂–¥—ã–π –ø—Ä–æ–∫—Å–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
‚Üí –†–æ—Ç–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É
```

---

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
```
Bot —Å–æ–∑–¥–∞–µ—Ç 72+ –ø–∞—Ä—ã Token + Proxy:
Worker 0  ‚Üí Token #1  + Proxy #23 (IP: 1.2.3.4)
Worker 1  ‚Üí Token #2  + Proxy #67 (IP: 5.6.7.8)
...
Worker 71 ‚Üí Token #72 + Proxy #88 (IP: 10.11.12.13)
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è:
```
Worker 0:
  Scan 1-5 ‚Üí Token #1 + Proxy #23 (–æ–¥–∏–Ω IP)
  üîÑ AUTO-ROTATION (5 —Å–∫–∞–Ω–æ–≤ completed)
  Scan 6-10 ‚Üí Token #73 + Proxy #45 (–Ω–æ–≤—ã–π IP)
```

### –ü—Ä–∏ –æ—à–∏–±–∫–µ:
```
Worker 0:
  Scan ‚Üí Token #1 + Proxy #23 ‚Üí HTTP 403 ‚ùå
  üîÑ RETRY #1: Token #74 + Proxy #56 ‚Üí HTTP 403 ‚ùå
  üîÑ RETRY #2: Token #75 + Proxy #89 ‚Üí HTTP 200 ‚úÖ
  SUCCESS! Continue with Token #75 + Proxy #89
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –í—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ—à–ª–∏ lint ‚úÖ
- `get_session_for_worker()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ worker ‚úÖ
- `create_fresh_pair()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ –∏ retry ‚úÖ
- –ü—Ä–æ–∫—Å–∏ –ù–ï –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ ‚úÖ

### ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: link > manual list ‚úÖ
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `dict.fromkeys()` ‚úÖ
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç: 100 –ø—Ä–æ–∫—Å–∏ ‚úÖ

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`token_pool.py`**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ `proxy` –≤ TokenSession
   - –î–æ–±–∞–≤–ª–µ–Ω–æ `scan_count` –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏
   - –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `create_fresh_pair()`
   - –ú–µ—Ç–æ–¥—ã `increment_scan()` –∏ `needs_rotation()`

2. **`pyVintedVN/items/items.py`**
   - –£–±—Ä–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è —Å–º–µ–Ω–∞ –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ
   - –ü—Ä–æ–∫—Å–∏ –±–µ—Ä–µ—Ç—Å—è –∏–∑ session (–ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ç–æ–∫–µ–Ω—É)

3. **`core.py`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 5 —Å–∫–∞–Ω–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ retry (–Ω–æ–≤–∞—è –ø–∞—Ä–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ)
   - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç scan_count –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–∫–∞–Ω–∞

4. **`proxies.py`**
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç link –Ω–∞–¥ manual list
   - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–° 100 residential –ø—Ä–æ–∫—Å–∏:**
- ‚úÖ 72 –∞–∫—Ç–∏–≤–Ω—ã—Ö "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ –ö–∞–∂–¥—ã–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º IP
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–∫–∞–Ω–æ–≤
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –ø—Ä–æ–∫—Å–∏ (100, –Ω–µ 200)

**–≠—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ 72 –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Vinted!** ‚ú®

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `TOKEN_PROXY_BINDING.md` - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- `INTEGRATION_SUMMARY.md` - –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
- `FIX_WORKERS_CRITICAL.md` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ worker startup
- `CHANGES_PARALLEL_TOKENS.md` - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã –≤ main. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç.

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- –ü—Ä–æ–∫—Å–∏ –±—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å: **100** (–Ω–µ 200)
- –¢–æ–∫–µ–Ω—ã –±—É–¥—É—Ç –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø—Ä–æ–∫—Å–∏ (–æ–¥–∏–Ω —Ç–æ–∫–µ–Ω = –æ–¥–∏–Ω IP)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 5 —Å–∫–∞–Ω–æ–≤
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞!** üöÄ

