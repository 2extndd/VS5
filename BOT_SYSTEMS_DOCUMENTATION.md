# üîç Vinted Scanner Bot - –ü–æ–ª–Ω–∞—è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –°–∏—Å—Ç–µ–º

## üìã –û–±–∑–æ—Ä

**Vinted Scanner Bot** - —ç—Ç–æ –≤—ã—Å–æ–∫–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Vinted. –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏-–±–æ—Ç —Å–∏—Å—Ç–µ–º –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é —Ä–∞–±–æ—Ç—É 24/7.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –°–∏—Å—Ç–µ–º—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **Core Engine** (`core.py`) - –õ–æ–≥–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. **Vinted API Wrapper** (`pyVintedVN/`) - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ Vinted API
3. **Token Pool System** (`token_pool.py`) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. **Proxy System** (`proxies.py`) - –†–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤
5. **Railway Auto-Redeploy** (`railway_redeploy.py`) - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–µ–ø–ª–æ–π
6. **Web UI** (`web_ui_plugin/`) - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
7. **Telegram Integration** (`telegram_bot_plugin/`) - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
8. **Database** (`db.py`) - –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üîç –°–∏—Å—Ç–µ–º–∞ –ü–æ–∏—Å–∫–∞ –¢–æ–≤–∞—Ä–æ–≤

### –ö–∞–∫ –ë–æ—Ç –ò—â–µ—Ç –í–µ—â–∏

#### 1Ô∏è‚É£ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ü–æ–∏—Å–∫–æ–≤—ã—Ö –ó–∞–ø—Ä–æ—Å–æ–≤

```sql
-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã queries
CREATE TABLE queries (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    query TEXT,           -- URL –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ Vinted
    last_item NUMERIC,    -- ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
    query_name TEXT,      -- –ù–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    thread_id INTEGER     -- ID –≤–æ—Ä–∫–µ—Ä–∞ (–¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏)
);
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
https://www.vinted.de/catalog?search_text=&catalog_ids=257&brand_ids=6397426&size_ids=&material_ids=&status_ids=&country_ids=&city_ids=&is_for_swap=&currency=EUR&price_to=40&price_from=&page=1&per_page=2&order=newest_first&time=
```

#### 2Ô∏è‚É£ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞

- **72 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞** (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—ã–π query)
- **ThreadPoolExecutor** –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ö–∞–∂–¥—ã–π –≤–æ—Ä–∫–µ—Ä** —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Å–≤–æ–π query –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥
- **‚ö° –ú–ì–ù–û–í–ï–ù–ù–´–ô –°–¢–ê–†–¢** - –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–µ—Ç staggered delay!)

```python
# core.py - –∑–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤ (–ë–ï–ó –ó–ê–î–ï–†–ñ–ï–ö!)
executor = ThreadPoolExecutor(max_workers=len(all_queries))

# –í—Å–µ –≤–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –ú–ì–ù–û–í–ï–ù–ù–û —Å start_delay=0
for idx, query in enumerate(all_queries):
    executor.submit(continuous_query_worker, query, queue, start_delay=0)
```

**üî• –ü–æ—á–µ–º—É –Ω–µ—Ç staggered start:**
- –¢–æ–∫–µ–Ω—ã —É–∂–µ **pre-warmed** (—Å–æ–∑–¥–∞–Ω—ã –∑–∞—Ä–∞–Ω–µ–µ)
- –í–æ—Ä–∫–µ—Ä—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–±–µ—Ä—É—Ç –≥–æ—Ç–æ–≤—ã–µ –∏–∑ pool)
- –í—Å–µ 72 –≤–æ—Ä–∫–µ—Ä–∞ –Ω–∞—á–∏–Ω–∞—é—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**

#### 3Ô∏è‚É£ –¶–∏–∫–ª –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –í–æ—Ä–∫–µ—Ä–∞

```python
def continuous_query_worker(query, queue, start_delay=0):
    while True:
        # 1. –ß–∏—Ç–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –ë–î –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        refresh_delay = db.get_parameter("query_refresh_delay") or 15
        items_per_query = db.get_parameter("items_per_query") or 20

        # 2. –ü–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–∑ –ø—É–ª–∞
        token_session = token_pool.get_session_for_worker(query_id)

        # 3. –î–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Vinted API
        search_result = vinted.items.search(query_url, nbr_items=items_per_query)

        # 4. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞)
        # 5. –°–ø–∏—Ç refresh_delay —Å–µ–∫—É–Ω–¥
        time.sleep(refresh_delay)
```

#### 4Ô∏è‚É£ –û–±—Ä–∞–±–æ—Ç–∫–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- **–£—Å–ø–µ—à–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã** ‚Üí –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- **–î—É–±–ª–∏–∫–∞—Ç—ã** ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- **–ù–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Telegram –∏ Web UI

---

## ü§ñ –°—É–ø–µ—Ä—á–∞—Ç –≤ Telegram

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—É–ø–µ—Ä—á–∞—Ç–∞

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Telegram Super Group** —Å —Ç–æ–ø–∏–∫–∞–º–∏ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```
/superchat
‚îú‚îÄ‚îÄ üì± Tech & Phones (topic_id: 1)
‚îú‚îÄ‚îÄ üëï Fashion (topic_id: 2)
‚îú‚îÄ‚îÄ üè† Home & Garden (topic_id: 3)
‚îú‚îÄ‚îÄ üéÆ Gaming (topic_id: 4)
‚îî‚îÄ‚îÄ üíº Business (topic_id: 5)
```

### –õ–æ–≥–∏–∫–∞ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** —Ç–æ–≤–∞—Ä–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
2. **–ú–∞–ø–ø–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** –Ω–∞ topic_id –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
3. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–ø–∏–∫

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
categories = {
    "phone": 1, "iphone": 1, "samsung": 1, "tech": 1,
    "fashion": 2, "clothing": 2, "shoes": 2,
    "home": 3, "furniture": 3, "garden": 3,
    "gaming": 4, "ps5": 4, "xbox": 4,
    "business": 5, "laptop": 5, "office": 5
}
```

### –§–æ—Ä–º–∞—Ç –°–æ–æ–±—â–µ–Ω–∏–π

```
üí∂40.0 EUR (+3 min) ‚õìÔ∏è 43 Dior
[–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞]
[–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä]
```

- **–¶–µ–Ω–∞** —Å –≤–∞–ª—é—Ç–æ–π
- **–ó–∞–¥–µ—Ä–∂–∫–∞** –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (+X min)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ** (‚õìÔ∏è X)
- **–ë—Ä–µ–Ω–¥** —Ç–æ–≤–∞—Ä–∞

---

## üõ°Ô∏è –°–∏—Å—Ç–µ–º—ã –ó–∞—â–∏—Ç—ã –æ—Ç –ë–∞–Ω–∞

### 1Ô∏è‚É£ Token Pool System

#### üî• PRE-WARMING: –¢–æ–∫–µ–Ω—ã –°–æ–∑–¥–∞—é—Ç—Å—è –î–û –°—Ç–∞—Ä—Ç–∞ –í–æ—Ä–∫–µ—Ä–æ–≤

```python
class TokenPool:
    def __init__(self, target_size=72, max_size=100, prewarm=True):
        self.target_size = target_size  # 72 —Ç–æ–∫–µ–Ω–∞ –¥–ª—è 72 –≤–æ—Ä–∫–µ—Ä–æ–≤
        self.sessions = []  # –ü—É–ª –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
        
        # üî• PRE-WARMING: —Å–æ–∑–¥–∞–µ–º –í–°–ï —Ç–æ–∫–µ–Ω—ã —Å—Ä–∞–∑—É –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        if prewarm:
            self._prewarm_pool()
    
    def _prewarm_pool(self):
        """
        –°–æ–∑–¥–∞–µ—Ç –í–°–ï 72 —Ç–æ–∫–µ–Ω–∞ –ó–ê–†–ê–ù–ï–ï (–¥–æ —Å—Ç–∞—Ä—Ç–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤).
        –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Ä–∫–µ—Ä–∞–º —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –ú–ì–ù–û–í–ï–ù–ù–û!
        """
        for i in range(self.target_size):
            proxy_dict = proxies.get_random_proxy()
            session = self._create_new_session_with_proxy(proxy_dict)
            if session:
                self.sessions.append(session)
            
            # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–æ–≤
            # 0.8 —Å–µ–∫ √ó 72 = ~60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤–µ—Å—å –ø—É–ª
            time.sleep(0.8)
        
        # –ü–æ—Å–ª–µ pre-warming –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –≥–æ—Ç–æ–≤—ã!
        # –í–æ—Ä–∫–µ—Ä—ã –º–æ–≥—É—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –ú–ì–ù–û–í–ï–ù–ù–û

    def get_session_for_worker(self, worker_id):
        # –í–æ—Ä–∫–µ—Ä –ø—Ä–æ—Å—Ç–æ –ë–ï–†–ï–¢ –≥–æ—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω (–Ω–µ —Å–æ–∑–¥–∞–µ—Ç!)
        session_idx = worker_id % len(self.sessions)
        return self.sessions[session_idx]
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Pre-warming:**
- ‚úÖ –í—Å–µ —Ç–æ–∫–µ–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è **–î–û** —Å—Ç–∞—Ä—Ç–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤ (–∑–∞ ~60 —Å–µ–∫)
- ‚úÖ –í–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç **–ú–ì–ù–û–í–ï–ù–ù–û** (–Ω–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)
- ‚úÖ –ü–µ—Ä–≤—ã–π —Å–∫–∞–Ω –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–°–†–ê–ó–£** –¥–ª—è –≤—Å–µ—Ö 72 –≤–æ—Ä–∫–µ—Ä–æ–≤
- ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –Ω–∞—Ö–æ–¥–∫–∞–º–∏ = **–¢–û–õ–¨–ö–û Query Refresh Delay** (60 —Å–µ–∫)
- ‚úÖ –ù–µ—Ç –±–æ–ª—å—à–µ –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ 3-5 –º–∏–Ω—É—Ç –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏!

#### 12 –†–∞–∑–Ω—ã—Ö User-Agent'–æ–≤

```python
USER_AGENTS = [
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/131.0.0.0",
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0",
    "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0",
    # ... –∏ –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
]
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ó–∞–º–µ–Ω–∞ –¢–æ–∫–µ–Ω–æ–≤

- **5+ –æ—à–∏–±–æ–∫** ‚Üí —Ç–æ–∫–µ–Ω –ø–æ–º–µ—á–∞–µ—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º
- **–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å** ‚Üí —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è –∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π
- **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ** ‚Üí –Ω–µ –≤—Å–µ —Ç–æ–∫–µ–Ω—ã —Å—Ä–∞–∑—É (–∞–Ω—Ç–∏ rate limit)

### 2Ô∏è‚É£ Proxy Rotation System

#### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –†–æ—Ç–∞—Ü–∏—è –ü—Ä–æ–∫—Å–∏

```python
# –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –º–µ–Ω—è–µ—Ç –ø—Ä–æ–∫—Å–∏
if self.request_count % self.proxy_rotation_interval == 0:
    self.set_random_proxy()

# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å = –Ω–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏
proxy_rotation_interval = 1
```

#### –ü—É–ª –∏–∑ 196 –†–∞–±–æ—á–∏—Ö –ü—Ä–æ–∫—Å–∏

- **–ò—Å—Ç–æ—á–Ω–∏–∫:** webshare.io (100 –ø—Ä–æ–∫—Å–∏)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –Ω–∞ vinted.de
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** 2xx/3xx —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã, timeout 10 —Å–µ–∫

#### –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ü—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ü—Ä–æ–∫—Å–∏

```python
def rotate_proxy(self):
    current_proxy = self.session.proxies.get('http', '')
    # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏, –ò–°–ö–õ–Æ–ß–ê–Ø —Ç–µ–∫—É—â–∏–π "–ø–ª–æ—Ö–æ–π"
    new_proxy = proxies.get_fresh_proxy(exclude_proxy=current_proxy_str)
```

### 3Ô∏è‚É£ Rate Limiting & Request Delays

#### Query Refresh Delay

- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π** —á–µ—Ä–µ–∑ Web UI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60 —Å–µ–∫)
- **–ß–∏—Ç–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏** –∏–∑ –ë–î –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é
- **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –≤–æ—Ä–∫–µ—Ä—É** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

#### ‚ùå Staggered Worker Start - –£–î–ê–õ–ï–ù!

**–°–¢–ê–†–ê–Ø —Å–∏—Å—Ç–µ–º–∞ (–¥–æ 06.10.2025):**
```python
# –í–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ (—Å–æ–∑–¥–∞–≤–∞–ª–æ 3-5 –º–∏–Ω —Ä–∞–∑–Ω–∏—Ü—É –≤ –Ω–∞—Ö–æ–¥–∫–∞—Ö!)
start_delay = (idx * 60.0) / num_queries  # ‚ùå –ë–û–õ–¨–®–ï –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
```

**–ù–û–í–ê–Ø —Å–∏—Å—Ç–µ–º–∞ (—Å 06.10.2025):**
```python
# –í–°–ï –≤–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –ú–ì–ù–û–í–ï–ù–ù–û
start_delay = 0  # ‚úÖ –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫!

# –ó–∞—â–∏—Ç–∞ –æ—Ç –±–∞–Ω–∞ —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑:
# 1. Pre-warming —Ç–æ–∫–µ–Ω–æ–≤ (—Å–æ–∑–¥–∞—é—Ç—Å—è –î–û —Å—Ç–∞—Ä—Ç–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤)
# 2. Token Pool —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
# 3. Proxy rotation –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
```

### 4Ô∏è‚É£ Session Management

#### Bearer –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
response = session.get("https://www.vinted.de/")
access_token = session.cookies['access_token_web']

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
session.headers["Authorization"] = f"Bearer {access_token}"
```

#### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¢–æ–∫–µ–Ω–æ–≤

- **–ü—Ä–∏ 401/403 –æ—à–∏–±–∫–∞—Ö** ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- **–î–æ 5 –ø–æ–ø—ã—Ç–æ–∫** —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
- **Fallback** –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏

### 5Ô∏è‚É£ Request Headers Emulation

#### –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ó–∞–≥–æ–ª–æ–≤–∫–∏

```python
headers = {
    "Accept": "application/json, text/plain, */*",
    "Accept-Language": "de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7",
    "Sec-Fetch-Dest": "empty",
    "Sec-Fetch-Mode": "cors",
    "Sec-Fetch-Site": "same-origin",
    "X-Requested-With": "XMLHttpRequest",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/131.0.0.0"
}
```

---

## üë• Workers Status (Last 3 Cycles)

### –†–µ–∞–ª—Ç–∞–π–º –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –í–æ—Ä–∫–µ—Ä–æ–≤

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–∞–Ω–Ω—ã—Ö

```python
_worker_stats = {
    worker_id: {
        'last_success': datetime,     # –ü–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—à–Ω—ã–π —Å–∫–∞–Ω
        'last_error': datetime,       # –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞
        'total_scans': int,          # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞–Ω–æ–≤
        'total_items': int,          # –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
        'total_errors': int,         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
        'recent_scans': [            # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Ü–∏–∫–ª–∞
            {'time': datetime, 'status': 'success/error', 'items': int}
        ]
    }
}
```

#### –õ–æ–≥–∏–∫–∞ –°—Ç–∞—Ç—É—Å–∞

```javascript
// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º 3 —Ü–∏–∫–ª–∞–º
const hasRecentErrors = recentScans.some(scan => scan.status === 'error');

if (hasRecentErrors) {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ —Å–µ–∫—Ü–∏–∏ –æ—à–∏–±–æ–∫
    errorWorkers.push(workerData);
} else {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö
    activeWorkers.push(workerData);
}
```

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

- **–ë–µ–π–¥–∂–∏:** `‚úÖN` (—É—Å–ø–µ—à–Ω—ã–π), `‚ùåN` (–æ—à–∏–±–∫–∏), `üì≠N` (–±–µ–∑ –≤–µ—â–µ–π)
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** Total | Working OK | Recent Errors | Idle
- **–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫:** –°–≤–µ—Ä–Ω—É—Ç–∞—è —Å–µ–∫—Ü–∏—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π

---

## üö® Railway Auto-Redeploy System

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –†–µ—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –ü—Ä–æ–±–ª–µ–º–∞—Ö

#### –£—Å–ª–æ–≤–∏—è –†–µ—Å—Ç–∞—Ä—Ç–∞

1. **–ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç:**
   - –ü—Ä–æ—à–ª–æ ‚â• threshold_minutes —Å –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏
   - –ù–∞–∫–æ–ø–∏–ª–æ—Å—å ‚â• max_http_errors –æ—à–∏–±–æ–∫

2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Å—Ç–∞—Ä—Ç:**
   - –ù–∞–∫–æ–ø–∏–ª–æ—Å—å ‚â• 100 –æ—à–∏–±–æ–∫ (–ª—é–±–æ–≥–æ —Ç–∏–ø–∞)

3. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç:**
   - –ß–µ—Ä–µ–∑ Web UI –∫–Ω–æ–ø–∫–∞ "Force Redeploy"

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)

```sql
-- –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
redeploy_threshold_minutes = 4  -- –ú–∏–Ω—É—Ç —Å –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏
max_http_errors = 5             -- –ú–∏–Ω. –æ—à–∏–±–æ–∫ –¥–ª—è —Ä–µ—Å—Ç–∞—Ä—Ç–∞
min_redeploy_interval_minutes = 3 -- –ú–∏–Ω. –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏
```

#### 6-–£—Ä–æ–≤–Ω–µ–≤–∞—è –¶–µ–ø–æ—á–∫–∞ –†–µ—Å—Ç–∞—Ä—Ç–∞ (—Å 06.10.2025)

```python
def _perform_redeploy(self):
    # 1Ô∏è‚É£ –ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ Railway GraphQL API
    if self.api_token:
        response = requests.post("https://backboard.railway.com/graphql/v2",
                                json=payload, headers=headers)
        if success: return True
    
    # 2Ô∏è‚É£ Fallback —á–µ—Ä–µ–∑ Railway CLI
    result = subprocess.run(["railway", "redeploy", "-y"])
    if result.returncode == 0: return True
    
    # 3Ô∏è‚É£ Fallback —á–µ—Ä–µ–∑ HTTP REST API
    response = requests.post(
        f"https://backboard.railway.com/projects/{project_id}/services/{service_id}/redeploy",
        headers={"Authorization": f"Bearer {api_token}"}
    )
    if response.status_code in [200, 201, 202]: return True
    
    # 4Ô∏è‚É£ Emergency: –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ Webhook
    if webhook_url:
        response = requests.post(webhook_url)
        if response.status_code in [200, 201, 202]: return True
    
    # 5Ô∏è‚É£ Emergency Exit (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω ALLOW_EMERGENCY_EXIT=true)
    if os.getenv('ALLOW_EMERGENCY_EXIT') == 'true':
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º SIGTERM —Å–∞–º–æ–º—É —Å–µ–±–µ
        os.kill(os.getpid(), signal.SIGTERM)  # Exit code 143 (graceful shutdown)
        # Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        return True
    
    # 6Ô∏è‚É£ Fake Redeploy (–ø–æ—Å–ª–µ–¥–Ω–∏–π fallback, –ë–ï–ó –∫—Ä–∞—à–∞)
    # –ü—Ä–æ—Å—Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
    self._reset_error_tracking()
    return False
```

#### ü©∫ Railway Redeploy - –†–µ–∞–ª—å–Ω–æ–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ

**–ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:**
```python
# os._exit(1) - –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Ä–∞–±–æ—á–∏–π –º–µ—Ç–æ–¥
os._exit(1)  # Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

# ALLOW_EMERGENCY_EXIT='true' –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

**–ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢:**
- ‚ùå Railway GraphQL API ‚Üí 404 errors
- ‚ùå Railway CLI ‚Üí –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- ‚ùå Railway HTTP REST API ‚Üí 404 Not Found  
- ‚ùå SIGTERM –≤–º–µ—Å—Ç–æ exit(1) ‚Üí –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- ‚ö†Ô∏è Webhook ‚Üí –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –æ–±—ã—á–Ω–æ –Ω–µ—Ç

**–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
1. –ë—ã–ª–∞ –≤–µ—Ä—Å–∏—è cf7b0fb —Å `os._exit(1)` ‚Üí –†–ê–ë–û–¢–ê–õ–ê ‚úÖ
2. –ü–æ–ø—ã—Ç–∫–∞ —É–ª—É—á—à–∏—Ç—å –Ω–∞ SIGTERM ‚Üí –ù–ï –†–ê–ë–û–¢–ê–õ–ê ‚ùå
3. –í–µ—Ä–Ω—É–ª–∏ `os._exit(1)` ‚Üí –†–ê–ë–û–¢–ê–ï–¢ ‚úÖ

**–†–µ—à–µ–Ω–∏–µ #2: Healthcheck endpoint**
```python
# –ù–æ–≤—ã–π endpoint: /health –∏ /healthcheck
@app.route('/health')
def healthcheck():
    return jsonify({
        "status": "healthy",
        "workers": len(db.get_queries()),
        "service": "vinted-bot"
    }), 200
```

**–†–µ—à–µ–Ω–∏–µ #3: railway.json –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
```json
{
  "deploy": {
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10,
    "healthcheckPath": "/health",
    "healthcheckTimeout": 100
  }
}
```

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ä–µ–¥–µ–ø–ª–æ—è:**
- `ALLOW_EMERGENCY_EXIT` - —Ä–∞–∑—Ä–µ—à–∏—Ç—å emergency exit —á–µ—Ä–µ–∑ os._exit(1) (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `true`)
- `RAILWAY_REDEPLOY_WEBHOOK` - URL webhook –¥–ª—è —Ä–µ–¥–µ–ø–ª–æ—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –æ–±—ã—á–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `RAILWAY_TOKEN` - —Ç–æ–∫–µ–Ω Railway API (–æ–±—ã—á–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - 404 errors)

**‚ö†Ô∏è –í–ê–ñ–ù–û:** Railway API/CLI –º–µ—Ç–æ–¥—ã –ù–ï –†–ê–ë–û–¢–ê–Æ–¢ —Å—Ç–∞–±–∏–ª—å–Ω–æ (404/403 errors).
–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π –º–µ—Ç–æ–¥ - `os._exit(1)` –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

---

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫

### –ü–æ–ª–Ω—ã–π –ê–ª–≥–æ—Ä–∏—Ç–º –û–±—Ä–∞–±–æ—Ç–∫–∏ –û—à–∏–±–æ–∫

#### HTTP –û—à–∏–±–∫–∏ (401, 403, 429)

```python
# –í–æ—Ä–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç Vinted API
if isinstance(search_result, tuple) and len(search_result) == 2:
    response, status_code = search_result

    # –ù–ï–ú–ï–î–õ–ï–ù–ù–û —Å–æ–æ–±—â–∞–µ–º —Å–∏—Å—Ç–µ–º–µ —Ä–µ–¥–µ–ø–ª–æ—è
    if status_code == 403:
        report_403_error()  # ‚Üê –í redeploy system
    elif status_code == 401:
        report_401_error()  # ‚Üê –í redeploy system
    elif status_code == 429:
        report_429_error()  # ‚Üê –í redeploy system

    # –°–æ–æ–±—â–∞–µ–º —Ç–æ–∫–µ–Ω –ø—É–ª—É –æ–± –æ—à–∏–±–∫–µ
    token_pool.report_error(token_session)

    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–æ—Ä–∫–µ—Ä–∞
    update_worker_stats(query_id, 'error')
```

#### –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –û—à–∏–±–∫–∏

```python
except Exception as e:
    # –õ—é–±–∞—è –¥—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞ (network, parsing, etc.)

    # –ù–ï–ú–ï–î–õ–ï–ù–ù–û —Å–æ–æ–±—â–∞–µ–º —Ç–æ–∫–µ–Ω –ø—É–ª—É
    token_pool.report_error(token_session)

    # –ù–ï–ú–ï–î–õ–ï–ù–ù–û –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    update_worker_stats(query_id, 'error')

    # –ù–ï–ú–ï–î–õ–ï–ù–ù–û —Å–æ–æ–±—â–∞–µ–º redeploy system –∫–∞–∫ 403
    report_403_error()

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω
    if not token_session.is_valid:
        # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
        token_session = token_pool.get_session_for_worker(query_id)
```

#### –ó–∞–¥–µ—Ä–∂–∫–∞ –ú–µ–∂–¥—É –¶–∏–∫–ª–∞–º–∏

```python
# –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —É—Å–ø–µ—Ö–∞/–æ—à–∏–±–∫–∏
time.sleep(refresh_delay)  # ‚Üê –ñ–î–ï–¢ –°–õ–ï–î–£–Æ–©–ï–ì–û –¶–ò–ö–õ–ê

# –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è...
```

---

## üåê Proxy System

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü—É–ª–æ–º –ü—Ä–æ–∫—Å–∏

#### –§–µ—Ç—á–∏–Ω–≥ –ü—Ä–æ–∫—Å–∏

```python
def fetch_proxies_from_link(url: str) -> List[str]:
    response = requests.get(url, timeout=10)
    return [line.strip() for line in response.text.splitlines() if line.strip()]
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ü—Ä–æ–∫—Å–∏

```python
def check_proxies_parallel(proxies_list: List[str]) -> List[str]:
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ 10 –ø–æ—Ç–æ–∫–∞–º–∏
    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(check_proxy, proxy) for proxy in proxies_list]
        results = [future.result() for future in as_completed(futures)]

    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–∫—Å–∏
    return [proxy for proxy, is_valid in results if is_valid]
```

#### –í–∞–ª–∏–¥–∞—Ü–∏—è –ü—Ä–æ–∫—Å–∏

```python
def check_proxy(proxy: str) -> tuple[str, bool]:
    try:
        response = requests.get("https://www.vinted.de/",
                              proxies={"http": proxy, "https": proxy},
                              timeout=10, allow_redirects=True)

        # –ü—Ä–∏–Ω–∏–º–∞–µ–º 2xx –∏ 3xx —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã
        return proxy, 200 <= response.status_code < 400
    except:
        return proxy, False
```

#### –†–æ—Ç–∞—Ü–∏—è –ü—Ä–æ–∫—Å–∏

- **–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å** ‚Üí –Ω–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö** –ø—Ä–æ–∫—Å–∏ –∏–∑ —Ä–æ—Ç–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç

---

## üñ•Ô∏è Web UI

### –û—Å–Ω–æ–≤–Ω—ã–µ –§—É–Ω–∫—Ü–∏–∏

#### Dashboard (`/`)
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –∑–∞–ø—Ä–æ—Å–æ–≤, uptime
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- **Responsive –¥–∏–∑–∞–π–Ω** —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏

#### Items (`/items`)
- **–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤** —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- **–§–∏–ª—å—Ç—Ä—ã** –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –±—Ä–µ–Ω–¥–∞–º
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- **Card/List view** –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

#### Configuration (`/config`)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞:** Query Refresh Delay, Items per Query, etc.
- **Workers Status:** —Ä–µ–∞–ª—Ç–∞–π–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- **Railway Status:** –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–¥–µ–ø–ª–æ—è
- **Proxy Status:** –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—É–ª–∞ –ø—Ä–æ–∫—Å–∏

#### Logs (`/logs`)
- **–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã** —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —É—Ä–æ–≤–Ω—é
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –ª–æ–≥–æ–≤

### AJAX –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ò–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | –≠–ª–µ–º–µ–Ω—Ç | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –§—É–Ω–∫—Ü–∏—è |
|----------|---------|----------|---------|
| `/` | Dashboard stats | 10 —Å–µ–∫ | `refreshDashboard()` |
| `/items` | Items list | 10 —Å–µ–∫ | `refreshItems()` |
| `/logs` | Logs | 5 —Å–µ–∫ | `fetchLogs()` |
| `/config` | Workers Status | 30 —Å–µ–∫ | `refreshWorkerStats()` |
| `/config` | Redeploy Status | 30 —Å–µ–∫ | `refreshRedeployStatus()` |
| `/config` | Proxy Status | 45 —Å–µ–∫ | `refreshProxyStatus()` |

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```javascript
// –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –µ—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
if (document.visibilityState !== 'visible') return;

// –≠–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏ —Ä–µ—Å—É—Ä—Å—ã
```

---

## üìä –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

#### –¢–∞–±–ª–∏—Ü—ã

1. **queries** - –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
2. **items** - –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
3. **allowlist** - —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
4. **parameters** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞

#### –ö–ª—é—á–µ–≤—ã–µ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

```sql
INSERT INTO parameters (key, value) VALUES
('query_refresh_delay', '60'),           -- –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–∫–∞–Ω–∞–º–∏ (—Å–µ–∫)
('items_per_query', '20'),               -- –¢–æ–≤–∞—Ä–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å
('proxy_rotation_interval', '1'),        -- –†–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
('redeploy_threshold_minutes', '4'),     -- –ü–æ—Ä–æ–≥ —Ä–µ–¥–µ–ø–ª–æ—è (–º–∏–Ω)
('max_http_errors', '5'),               -- –ú–∞–∫—Å. –æ—à–∏–±–æ–∫ –¥–ª—è —Ä–µ–¥–µ–ø–ª–æ—è
('last_redeploy_time', ''),             -- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–¥–µ–ø–ª–æ—è
('telegram_enabled', 'False'),          -- –í–∫–ª—é—á–µ–Ω –ª–∏ Telegram
('telegram_token', ''),                 -- –¢–æ–∫–µ–Ω –±–æ—Ç–∞
('telegram_chat_id', ''),               -- ID —Å—É–ø–µ—Ä—á–∞—Ç–∞
('bot_start_time', '0');                -- –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
```

---

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **72 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞** ‚Üí 72 –∑–∞–ø—Ä–æ—Å–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
- **196 —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ–∫—Å–∏** ‚Üí —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Web UI** ‚Üí —Ä–µ–∞–ª—Ç–∞–π–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** ‚Üí –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **ThreadPoolExecutor** –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞
2. **Connection pooling** –≤ requests.Session
3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –∫ –ë–î —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
4. **–õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Railway API (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–¥–µ–ø–ª–æ—è)
RAILWAY_TOKEN=your_railway_token
RAILWAY_PROJECT_ID=your_project_id
RAILWAY_SERVICE_ID=your_service_id

# Database
DATABASE_URL=your_database_url

# Telegram
TELEGRAM_TOKEN=your_telegram_token
TELEGRAM_CHAT_ID=your_chat_id

# Redeploy Options (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
RAILWAY_REDEPLOY_WEBHOOK=https://your-webhook-url  # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ä–µ–¥–µ–ø–ª–æ—è
ALLOW_EMERGENCY_EXIT=true  # –†–∞–∑—Ä–µ—à–∏—Ç—å SIGTERM exit –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
```

### Railway –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π** –∏–∑ GitHub
- **PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Å –∞–≤—Ç–æ-–±—ç–∫–∞–ø–∞–º–∏
- **–õ–æ–≥–∏** –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Railway dashboard
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### railway.json

```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10,
    "healthcheckPath": "/health",
    "healthcheckTimeout": 100
  }
}
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:**
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `startCommand` –≤ railway.json - —ç—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç Procfile
- –ö–æ–º–∞–Ω–¥–∞ —Å—Ç–∞—Ä—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¢–û–õ–¨–ö–û –≤ `Procfile`
- `railway.json` —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ restart policy –∏ healthcheck

#### Procfile

```
web: pip install railway && python vinted_notifications.py
```

**–ü–æ—á–µ–º—É `pip install railway`:**
- Railway CLI –Ω—É–∂–µ–Ω –¥–ª—è –º–µ—Ç–æ–¥–∞ #2 —Ä–µ–¥–µ–ø–ª–æ—è
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Vinted Scanner Bot** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏ —Ä–µ–∞–ª—Ç–∞–π–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º. –°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º —Ä–∏—Å–∫–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω—Ç–∏-–±–æ—Ç —Å–∏—Å—Ç–µ–º–∞–º–∏ Vinted.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ 72 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
- ‚úÖ **Pre-warming —Ç–æ–∫–µ–Ω–æ–≤** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è 196 –ø—Ä–æ–∫—Å–∏
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±–∞–Ω–∞
- ‚úÖ –†–µ–∞–ª—Ç–∞–π–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ Web UI
- ‚úÖ **6-—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–¥–µ–ø–ª–æ—è** (GraphQL ‚Üí CLI ‚Üí HTTP ‚Üí Webhook ‚Üí SIGTERM ‚Üí Fake)
- ‚úÖ **Healthcheck** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è CrashLoopBackOff
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

**üî• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç 06.10.2025:**
- ‚ùå –£–±—Ä–∞–Ω staggered start (–∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω pre-warming —Ç–æ–∫–µ–Ω–æ–≤ (–≤—Å–µ —Ç–æ–∫–µ–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –î–û —Å—Ç–∞—Ä—Ç–∞)
- ‚úÖ –í–æ—Ä–∫–µ—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –ú–ì–ù–û–í–ï–ù–ù–û (start_delay=0)
- ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –Ω–∞—Ö–æ–¥–∫–∞–º–∏ = –¢–û–õ–¨–ö–û Query Refresh Delay (60 —Å–µ–∫)
- ‚úÖ `refresh_delay` –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –î–û try-except (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω undefined bug)
- ‚úÖ `clear_item_queue()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –í–°–ï —ç–ª–µ–º–µ–Ω—Ç—ã (–±—ã–ª–æ 1 ‚Üí —Å—Ç–∞–ª–æ –¥–æ 100)
- ‚úÖ Redeploy —á–µ—Ä–µ–∑ os._exit(1) –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ Healthcheck endpoint (/health) –¥–ª—è Railway –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ railway.json —Å restartPolicy (–ë–ï–ó startCommand!)

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É 24/7!** üöÄ
